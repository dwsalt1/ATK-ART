<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daftar ATK & ART</title>
  <style>
    :root{--accent:#2563eb;--muted:#666}
    body{font-family:Inter, system-ui, -apple-system, Roboto, 'Segoe UI', Arial; margin:0; padding:20px; background:#f7fbff}
    .container{max-width:980px;margin:0 auto;background:#fff;padding:18px;border-radius:10px;box-shadow:0 6px 22px rgba(20,20,60,0.06)}
    h1{margin:0 0 12px;font-size:20px}
    .flex{display:flex;gap:8px;align-items:center}
    input,select,button,textarea{padding:8px 10px;border-radius:8px;border:1px solid #e6e9ef;font-size:14px}
    .search{flex:1}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px 10px;border-bottom:1px solid #f0f2f6;text-align:left}
    th{background:#fbfdff;position:sticky;top:0}
    .actions button{margin-right:6px}
    .muted{color:var(--muted);font-size:13px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .small{padding:6px 8px;font-size:13px}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;background:#eef6ff;color:var(--accent);font-weight:600}
    @media(max-width:640px){table,thead,tbody,th,td,tr{display:block}thead{display:none}td{padding:10px 0;border-bottom:1px solid #eee}td:before{content:attr(data-label);display:block;font-weight:600;margin-bottom:6px}}
  </style>
</head>
<body>
  <div class="container">
    <div class="flex" style="justify-content:space-between">
      <div>
        <h1>Daftar ATK & ART <span class="badge">v1</span></h1>
        <div class="muted">Simpan, edit, dan ekspor daftar ATK/ART. Data tersimpan di browser.</div>
      </div>
      <div style="text-align:right">
        <button id="printBtn" class="small">Cetak</button>
      </div>
    </div>

    <div class="controls">
      <input id="search" class="search" placeholder="Cari item, lokasi, atau catatan..." />
      <select id="filterCategory">
        <option value="">Semua kategori</option>
        <option>ATK</option>
        <option>ART</option>
      </select>
      <button id="clearFilter" class="small">Reset</button>
      <button id="exportCsv" class="small">Ekspor CSV</button>
      <input id="importFile" type="file" accept=".csv" />
    </div>

    <form id="form" style="margin-top:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:8px;align-items:end">
     <div>
  <label>Nama Item</label>
  <select id="itemName" required>
    <option value="">-- Pilih Barang --</option>

    <!-- ATK -->
    <option>Amplop Coklat Folio</option>
    <option>Amplop Coklat MAP</option>
    <option>Amplop Coklat uk. 1/2 Folio (ocr)</option>
    <option>Amplop Jaya Putih (Uk. Panjang)</option>
    <option>Bantalan Stempel</option>
    <option>Binder Klip No.107</option>
    <option>Binder Klip No.111</option>
    <option>Binder Klip No.155</option>
    <option>Binder Klip No.200</option>
    <option>Box File</option>
    <option>Buku Kas 3 Kolom</option>
    <option>Buku Tanda Terima NURI</option>
    <option>Buku Tanda Terima UBSI</option>
    <option>Buku Telepon</option>
    <option>Buku Tulis Folio</option>
    <option>Clear Holder</option>
    <option>Cutter Besar</option>
    <option>Cutter Kecil</option>
    <option>Dispenser Selotip Lion Kecil</option>
    <option>Document Keeper</option>
    <option>Double Tip Uk. Besar</option>
    <option>Double Tip Uk. Kecil</option>
    <option>Fastener</option>
    <option>Gantungan Kunci Warna-Warni</option>
    <option>Gunting Uk. Besar</option>
    <option>Gunting Uk. Kecil</option>
    <option>Isi Cutter Besar</option>
    <option>Isi Cutter Kecil</option>
    <option>Isi Spidol Whiteboard</option>
    <option>Isi Stepler Besar</option>
    <option>Isi Stepler Kecil</option>
    <option>Kalkulator</option>
    <option>Kertas Fax</option>
    <option>Kertas HVS A4</option>
    <option>Kertas HVS Folio</option>
    <option>Kertas HVS Kwarto</option>
    <option>Klip Kertas Uk Kecil No.3</option>
    <option>Klip Kertas Uk Kecil No.5</option>
    <option>Kwitansi NURI</option>
    <option>Kwitansi UBSI</option>
    <option>Label Tom & Jerry No.103</option>
    <option>Lakban Bening</option>
    <option>Lakban Coklat</option>
    <option>Lakban Hitam</option>
    <option>Lem Fox</option>
    <option>Lem Stick/Pritt</option>
    <option>Map Presiden</option>
    <option>Odner Besar</option>
    <option>Odner Kecil</option>
    <option>Pembatas Buku Besi</option>
    <option>Penggaris</option>
    <option>Penggaris Besi</option>
    <option>Penghapus Pensil</option>
    <option>Penghapus Whiteboard</option>
    <option>Pensil 2B</option>
    <option>Post-It</option>
    <option>Pulpen Biru</option>
    <option>Pulpen Hitam</option>
    <option>Pulpen Meja Kotak</option>
    <option>Pulpen Merah</option>
    <option>Punch Hole</option>
    <option>Rautan Pensil Uk. Kecil</option>
    <option>Selotip</option>
    <option>Spidol Kecil Biru</option>
    <option>Spidol Kecil Hitam</option>
    <option>Spidol Kecil Merah</option>
    <option>Spidol Whiteboard Hitam</option>
    <option>Spidol Whiteboard Permanen</option>
    <option>Stabillo BOSS</option>
    <option>Stempel Tanggal</option>
    <option>Stepler MAX (Besar)</option>
    <option>Stepler MAX (Kecil)</option>
    <option>Tempat Pensil Resleting</option>
    <option>Tinta Stempel Warna Biru Merk Joyko</option>
    <option>Tip-Ex Bentuk Pensil</option>

    <!-- ART -->
    <option>Batu Baterai A3 Remote AC & LCD</option>
    <option>Batu Baterai Alkaline A2</option>
    <option>Bayfresh Semprot</option>
    <option>Cairan Pembersih Kaca Refill</option>
    <option>Cairan Pembersih Kaca Refill + Tempat</option>
    <option>Carbol/Tripol/Wipol</option>
    <option>Ember</option>
    <option>Gayung</option>
    <option>Gula Pasir</option>
    <option>Kain Pel + Gagang</option>
    <option>Kain Pel Refill Segi Empat</option>
    <option>Kamper Buku</option>
    <option>Kanebo</option>
    <option>Kantong Plastik Sampah Hitam Besar</option>
    <option>Kantong Plastik Warna Putih</option>
    <option>Kemoceng</option>
    <option>Keset Kain</option>
    <option>Kopi Kapal Api</option>
    <option>Lap Serbet/Kaca</option>
    <option>Pembersih Lantai (Superpell)</option>
    <option>Pengki</option>
    <option>Raid/Baygon</option>
    <option>Rinso/Dino 100gr</option>
    <option>Sabun Cuci Cream Sunlight</option>
    <option>Sabun Cuci Ekonomi</option>
    <option>Sabun Cuci Tangan + Tempat</option>
    <option>Sabun Cuci Tangan Refill</option>
    <option>Sabut Kawat</option>
    <option>Sapu Ijuk</option>
    <option>Sapu Lidi</option>
    <option>Sikat Baju</option>
    <option>Sikat Kloset Ujung Bulat</option>
    <option>Sikat Lantai</option>
    <option>Spon Cuci Piring Uk. Besar</option>
    <option>Mama Lemon</option>
    <option>Tali Rapia</option>
    <option>Teh Celup Bendera</option>
    <option>Tempat Sampah Plastik Besar</option>
    <option>Tempat Sampah Plastik Kecil</option>
    <option>Tempat Tissue</option>
    <option>Tissue Refill</option>
    <option>Vixal/Porstek</option>
    <option>Tempat CD isi 80 Lbr</option>
    <option>Lampu Neon Pjg 16 watt LED</option>
    <option>Lampu Neon Pdk 8 watt LED</option>
    <option>Lampu Bulb 8 watt</option>
    <option>Lampu Tembak 50 watt</option>
    <option>Lampu Tembak 100 watt</option>
    <option>Lampu Essential 5 watt</option>
  </select>
</div>
      <div>
        <label>Kategori</label>
        <select id="category">
          <option>ATK</option>
          <option>ART</option>
        </select>
      </div>
      <div>
        <label>Jumlah</label>
        <input id="qty" type="number" min="0" value="1" />
      </div>
      <div>
        <label>Satuan</label>
        <input id="unit" placeholder="pcs, pack, box" />
      </div>
      <div>
        <label>Lokasi</label>
        <input id="location" placeholder="Gudang, Ruang Admin..." />
      </div>
      <div>
        <label>Catatan</label>
        <input id="note" />
      </div>
      <div style="grid-column:1/-1;display:flex;gap:8px">
        <button id="saveBtn">Tambah / Simpan</button>
        <button id="cancelEdit" type="button" class="small">Batal</button>
      </div>
    </form>

    <table id="table">
      <thead>
        <tr>
          <th>#</th>
          <th>Nama Item</th>
          <th>Kategori</th>
          <th>Jumlah</th>
          <th>Satuan</th>
          <th>Lokasi</th>
          <th>Catatan</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div style="margin-top:10px" class="muted">Tip: Gunakan tombol Ekspor untuk menyimpan backup CSV.</div>
  </div>

  <script>
    // Simple list manager using localStorage
    const LS_KEY = 'daftar_atk_art_2025';
    let data = JSON.parse(localStorage.getItem(LS_KEY) || '[]');
    let editId = null;

    const $ = id => document.getElementById(id);
    const tbody = document.querySelector('#table tbody');

    function render() {
      const q = $('search').value.trim().toLowerCase();
      const catFilter = $('filterCategory').value;
      tbody.innerHTML = '';
      const filtered = data.filter((row) => {
        if (catFilter && row.category !== catFilter) return false;
        if (!q) return true;
        return [row.name, row.location, row.note, row.unit, row.category].some(f => (f||'').toLowerCase().includes(q));
      });
      filtered.forEach((r, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td data-label="#">${i+1}</td>
          <td data-label="Nama Item">${escapeHtml(r.name)}</td>
          <td data-label="Kategori">${escapeHtml(r.category)}</td>
          <td data-label="Jumlah">${r.qty}</td>
          <td data-label="Satuan">${escapeHtml(r.unit)}</td>
          <td data-label="Lokasi">${escapeHtml(r.location)}</td>
          <td data-label="Catatan">${escapeHtml(r.note)}</td>
          <td data-label="Aksi" class="actions">
            <button onclick="editItem('${r.id}')">Edit</button>
            <button onclick="deleteItem('${r.id}')">Hapus</button>
          </td>`;
        tbody.appendChild(tr);
      });
    }

    function saveData(){ localStorage.setItem(LS_KEY, JSON.stringify(data)); }

    function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,7); }

    function escapeHtml(s){ if(!s) return ''; return s.replace(/[&<>\"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','\\':'\\\\','"':'&quot;'}[c])); }

    // form
    document.getElementById('form').addEventListener('submit', e => {
      e.preventDefault();
      const item = {
        id: editId || uid(),
        name: $('itemName').value.trim(),
        category: $('category').value,
        qty: Number($('qty').value) || 0,
        unit: $('unit').value.trim(),
        location: $('location').value.trim(),
        note: $('note').value.trim()
      };
      if (editId){
        data = data.map(d => d.id===editId ? item : d);
        editId = null;
      } else {
        data.push(item);
      }
      saveData(); render(); e.target.reset();
    });

    window.editItem = function(id){
      const item = data.find(d => d.id===id); if(!item) return;
      editId = id;
      $('itemName').value = item.name;
      $('category').value = item.category;
      $('qty').value = item.qty;
      $('unit').value = item.unit;
      $('location').value = item.location;
      $('note').value = item.note;
      window.scrollTo({top:0,behavior:'smooth'});
    }

    window.deleteItem = function(id){
      if(!confirm('Hapus item ini?')) return;
      data = data.filter(d => d.id!==id);
      saveData(); render();
    }

    $('search').addEventListener('input', render);
    $('filterCategory').addEventListener('change', render);
    $('clearFilter').addEventListener('click', () => { $('search').value=''; $('filterCategory').value=''; render(); });

    // export CSV
    function toCsv(rows){
      const header = ['Nama Item','Kategori','Jumlah','Satuan','Lokasi','Catatan'];
      const lines = [header.join(',')];
      rows.forEach(r => {
        const cols = [r.name, r.category, r.qty, r.unit, r.location, r.note];
        lines.push(cols.map(c => '"' + (''+ (c||'')).replace(/"/g,'""') + '"').join(','));
      });
      return lines.join('\n');
    }

    $('exportCsv').addEventListener('click', () => {
      const csv = toCsv(data);
      const blob = new Blob([csv], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'daftar_atk_art.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // import CSV (very simple)
    $('importFile').addEventListener('change', (e) => {
      const f = e.target.files[0]; if(!f) return;
      const reader = new FileReader();
      reader.onload = ev => {
        const text = ev.target.result;
        const lines = text.split(/\r?\n/).filter(l => l.trim());
        const parsed = [];
        for(let i=1;i<lines.length;i++){
          const cols = parseCsvLine(lines[i]);
          if(cols.length<1) continue;
          parsed.push({id: uid(), name: cols[0]||'', category: cols[1]||'ATK', qty: Number(cols[2]||0), unit: cols[3]||'', location: cols[4]||'', note: cols[5]||''});
        }
        if(parsed.length){ if(confirm('Tambahkan '+parsed.length+' item dari file?')){ data = data.concat(parsed); saveData(); render(); }}
      }
      reader.readAsText(f);
      e.target.value='';
    });

    function parseCsvLine(line){
      const out = []; let cur=''; let inQ=false;
      for(let i=0;i<line.length;i++){
        const ch=line[i];
        if(inQ){
          if(ch==='"'){ if(line[i+1]==='"'){ cur += '"'; i++; } else { inQ=false; } }
          else cur += ch;
        } else {
          if(ch===','){ out.push(cur); cur=''; }
          else if(ch==='"'){ inQ=true; }
          else cur += ch;
        }
      }
      out.push(cur);
      return out;
    }

    // print
    $('printBtn').addEventListener('click', () => { window.print(); });

    // cancel edit
    $('cancelEdit').addEventListener('click', () => { editId=null; document.getElementById('form').reset(); });

    // initial render
    render();
  </script>
</body>
</html>
